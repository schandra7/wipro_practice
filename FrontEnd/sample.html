<!doctype html>
<html >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nice Calculator</title>
  <style>
    :root{
      --bg:#0f1724;
      --panel:#0b1220;
      --accent:#7c5cff;
      --accent-2:#00d4ff;
      --btn:#1b2430;
      --btn-2:#263445;
      --glass: rgba(255,255,255,0.03);
      --text:#e6eef8;
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0;
      font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(124,92,255,0.12), transparent 8%),
                  radial-gradient(900px 500px at 90% 90%, rgba(0,212,255,0.06), transparent 6%),
                  var(--bg);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:32px;
      color:var(--text);
    }
 
    .calculator{
      width:360px;
      max-width:95vw;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:18px;
      box-shadow: 0 8px 30px rgba(2,6,23,0.7), inset 0 1px 0 rgba(255,255,255,0.02);
      padding:18px;
      border:1px solid rgba(255,255,255,0.03);
    }
 
    .screen{
      height:86px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:12px;
      padding:12px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      margin-bottom:14px;
      border:1px solid rgba(255,255,255,0.02);
    }
 
    .small-display{
      font-size:14px;
      color:rgba(230,238,248,0.65);
      text-align:right;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
 
    .main-display{
      font-size:32px;
      font-weight:600;
      text-align:right;
      letter-spacing:0.4px;
      word-break:break-all;
    }
 
    .keys{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
    }
 
    button.key{
      height:58px;
      border-radius:12px;
      border:0;
      background:linear-gradient(180deg,var(--btn),var(--btn-2));
      color:var(--text);
      font-size:18px;
      box-shadow: 0 6px 18px rgba(2,6,23,0.5);
      cursor:pointer;
      transition: transform .08s ease, box-shadow .08s ease, filter .08s ease;
    }
    button.key:active{ transform: translateY(2px) scale(.998); }
    button.key.operator{ background: linear-gradient(180deg,var(--accent), var(--accent-2)); color:#061224; font-weight:700; }
    button.key.accent{ background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01)); color:rgba(230,238,248,0.9); }
 
    button.key.wide{ grid-column: span 2; }
 
    .footer{
      margin-top:12px;
      display:flex;
      justify-content:space-between;
      font-size:12px;
      color:rgba(230,238,248,0.55);
    }
 
    .hint{color:rgba(230,238,248,0.45)}
 
    @media (max-width:420px){
      .screen{height:76px}
      .main-display{font-size:28px}
      button.key{height:50px;font-size:17px}
    }
  </style>
</head>
 
<body>
  <main class="calculator" role="application" aria-label="Calculator">
    <section class="screen" aria-live="polite">
      <div class="small-display" id="expression">0</div>
      <div class="main-display" id="result">0</div>
    </section>
 
    <section class="keys" role="group" aria-label="Calculator keys">
      <button class="key accent" data-action="clear">C</button>
      <button class="key accent" data-action="back">⌫</button>
      <button class="key accent" data-action="percent">%</button>
      <button class="key operator" data-value="/">÷</button>
 
      <button class="key" data-value="7">7</button>
      <button class="key" data-value="8">8</button>
      <button class="key" data-value="9">9</button>
      <button class="key operator" data-value="*">×</button>
 
      <button class="key" data-value="4">4</button>
      <button class="key" data-value="5">5</button>
      <button class="key" data-value="6">6</button>
      <button class="key operator" data-value="-">−</button>
 
      <button class="key" data-value="1">1</button>
      <button class="key" data-value="2">2</button>
      <button class="key" data-value="3">3</button>
      <button class="key operator" data-value="+">+</button>
 
      <button class="key wide" data-action="negate">±</button>
      <button class="key" data-value="0">0</button>
      <button class="key" data-value=".">.</button>
      <button class="key operator" data-action="equals">=</button>
    </section>
 
    <div class="footer">
      <div class="hint">Tip: use keyboard numbers and Enter for =</div>
      <div>Made with ♥</div>
    </div>
  </main>
 
 
<script>
    (function(){
      const expressionEl = document.getElementById('expression');
      const resultEl = document.getElementById('result');
 
      let expr = '';
      let lastAnswer = '';
 
      function updateDisplays(){
        expressionEl.textContent = expr || '0';
        resultEl.textContent = lastAnswer || '0';
      }
 
      function pushValue(val){
        // avoid multiple operators in a row (except minus for negative)
        if (/^[+\-*\/%]$/.test(val)){
          if (!expr) {
            // allow leading minus for negative numbers
            if (val === '-') { expr = '-'; updateDisplays(); return; }
            return;
          }
          // replace last operator if user typed another
          if (/[+\-*\/%]$/.test(expr)){
            expr = expr.slice(0,-1) + val;
            updateDisplays();
            return;
          }
        }
 
        // avoid multiple decimals in the same number
        if (val === '.'){
          const parts = expr.split(/[+\-*\/%]/);
          const last = parts[parts.length-1] || '';
          if (last.includes('.')) return;
          if (last === '') expr += '0';
        }
 
        expr += val;
        updateDisplays();
      }
 
      function clearAll(){ expr = ''; lastAnswer = ''; updateDisplays(); }
      function backspace(){ expr = expr.slice(0,-1); updateDisplays(); }
 
      function evaluateExpression(){
        if (!expr) return;
        // sanitize: only allow digits, operators, dot, parentheses
        if (!/^[-+*/%(). 0-9]+$/.test(expr)){
          lastAnswer = 'Error'; updateDisplays(); return;
        }
        try{
          // replace unicode signs just in case
          const safeExpr = expr.replace(/×/g,'*').replace(/÷/g,'/').replace(/−/g,'-');
          // simple percentage handling: convert a%B to (a/100)*B when used as binary operator
          // but to keep it lightweight: convert standalone % after number to '/100'
          const pctExpr = safeExpr.replace(/(\d+(?:\.\d+)?)%/g, '($1/100)');
          // Use Function instead of eval (slightly safer)
          // eslint-disable-next-line no-new-func
          const value = Function('return (' + pctExpr + ')')();
          if (value === Infinity || Number.isNaN(value)) throw Error('Bad result');
          lastAnswer = String(Number.isFinite(value) ? +(+value).toFixed(12) : value).replace(/\.0+$|(?<=\.[0-9]*[1-9])0+$/,'');
          expr = '';
          updateDisplays();
        }catch(e){ lastAnswer = 'Error'; updateDisplays(); }
      }
 
      // click handling
      document.querySelectorAll('button.key').forEach(btn => {
        btn.addEventListener('click', () => {
          const v = btn.getAttribute('data-value');
          const action = btn.getAttribute('data-action');
          if (action){
            if (action === 'clear') clearAll();
            else if (action === 'back') backspace();
            else if (action === 'equals') evaluateExpression();
            else if (action === 'percent') {
              pushValue('%');
            }
            else if (action === 'negate') {
              // simple negate: if there's a last answer, negate it; otherwise toggle leading -
              if (!expr && lastAnswer){ lastAnswer = String(-Number(lastAnswer)); updateDisplays(); }
              else if (expr.startsWith('-')) expr = expr.slice(1);
              else expr = '-' + expr;
              updateDisplays();
            }
          } else if (v) {
            pushValue(v);
          }
        });
      });
 
      // keyboard support
      window.addEventListener('keydown', (e) => {
        if (e.key >= '0' && e.key <= '9') { pushValue(e.key); }
        else if (e.key === '.') pushValue('.')
        else if (['+','-','*','/','%'].includes(e.key)) pushValue(e.key);
        else if (e.key === 'Enter' || e.key === '=') { e.preventDefault(); evaluateExpression(); }
        else if (e.key === 'Backspace') backspace();
        else if (e.key === 'Escape') clearAll();
      });
 
      // initialize
      clearAll();
 
    })();
  </script>
</body>
</html>
 